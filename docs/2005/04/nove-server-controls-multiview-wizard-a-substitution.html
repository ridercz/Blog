<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Nové server controls: MultiView, Wizard a Substitution | ALTAIR.blog</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <meta name="Description" content="Naši prohlídku světa Whidbey započneme třemi jednoduchými ovládacími prvky" />
    <link rel="stylesheet" type="text/css" href="/content/styles.min.css?sha=0A8176D3C7A80FAC497B3EF5E576FF7C87B3A71E" />
    <link rel="stylesheet" type="text/css" href="/content/fa-5.1.0/css/all.css" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed.rss" title="RSS (všechny články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-internal.rss" title="RSS (pouze místní články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-external.rss" title="RSS (pouze odkazy)" />
    <link rel="shortcut icon" href="https://www.altair.blog/favicon.ico" />
    <link rel="icon" href="https://www.altair.blog/favicon.ico" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@ridercz" />
    <meta name="twitter:title" content="Nové server controls: MultiView, Wizard a Substitution" />
    <meta name="twitter:description" content="Naši prohlídku světa Whidbey započneme třemi jednoduchými ovládacími prvky" />
    <meta name="twitter:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="ALTAIR.blog" />
    <meta property="og:title" content="Nové server controls: MultiView, Wizard a Substitution" />
    <meta property="og:description" content="Naši prohlídku světa Whidbey započneme třemi jednoduchými ovládacími prvky" />
    <meta property="og:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="og:locale" content="cs_CZ" />
    <script>
      (function(f, a, t, h, o, m){
        a[h]=a[h]||function(){
          (a[h].q=a[h].q||[]).push(arguments)
        };
        o=f.createElement('script'),
        m=f.getElementsByTagName('script')[0];
        o.async=1; o.src=t; o.id='fathom-script';
        m.parentNode.insertBefore(o,m)
      })(document, window, '//stats.altair.blog/tracker.js', 'fathom');
      fathom('set', 'siteId', 'OBOTR');
      fathom('trackPageview');
    </script>
    <meta name="robots" content="index, follow" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/content/images/logo_onblack.svg" alt="altair.blog" style="height:100px;" />
        </a>
      </div>
    </header>
    <nav>
      <ul>
        <li>
          <a href="https://www.rider.cz/" title="Autor: Michal Altair Valášek">
            <i class="fal fa-user"> </i>
          </a>
        </li>
        <li>
          <a href="/archive" title="Archiv článků">
            <i class="fal fa-archive"> </i>
          </a>
        </li>
        <li>
          <a href="/categories" title="Rubriky">
            <i class="fal fa-tags"> </i>
          </a>
        </li>
        <li>
          <a href="/serials" title="Seriály">
            <i class="fal fa-list-alt"> </i>
          </a>
        </li>
        <li>
          <a href="/search" title="Vyhledávání">
            <i class="fal fa-search"> </i>
          </a>
        </li>
        <li>
          <a href="https://www.rider.cz/#contact" title="Kontakt">
            <i class="fal fa-envelope"> </i>
          </a>
        </li>
        <li>
          <a href="https://facebook.com/rider.cz" title="Facebook">
            <i class="fab fa-facebook"> </i>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/ridercz" title="Twitter">
            <i class="fab fa-twitter"> </i>
          </a>
        </li>
        <li>
          <a href="https://github.com/ridercz" title="Github">
            <i class="fab fa-github"> </i>
          </a>
        </li>
        <li>
          <a href="https://ask.fm/ridercz" title="Ask.fm">
            <i class="fal fa-question"> </i>
          </a>
        </li>
      </ul>
    </nav>
    <main>
      <h1>Nové server controls: MultiView, Wizard a Substitution</h1>
      <aside class="article-info">
        <ul class="categories">
          <li>
            <a href="/categories/it" title="Rubrika">
              <i class="fal fa-tag"> </i>IT</a>
          </li>
        </ul>
        <div>
          <a href="https://www.rider.cz/">Michal Altair Valášek </a>
          <i class="fal fa-user">​</i>
        </div>
        <div>
          <time datetime="2005-04-30T16:50:03.817+02:00" title="Datum vydání">30. dubna 2005 <i class="fal fa-calendar-alt">​</i></time>
        </div>
      </aside>
      <section class="article-text">
        <p __designer:dtid="1688849860263940">Na&#353;i prohl&#237;dku světa Whidbey započneme třemi jednoduch&#253;mi ovl&#225;dac&#237;mi prvky.</p>
<h2 __designer:dtid="1688849860263941">MultiView</h2>
<p __designer:dtid="1688849860263942">Pro zač&#225;tek něco lehč&#237;ho. Řada aplikac&#237; - alespoň m&#253;ch určitě - obsahuje str&#225;nky, kter&#233; sest&#225;vaj&#237; z několika č&#225;st&#237;, u kter&#253;ch je viditeln&#225; vždy pr&#225;vě jenom jedna. Ať už se jedn&#225; o obdobu "z&#225;ložek", nebo nějak&#233;ho průvodce... Ve verzi 1.x se tato situace ře&#353;&#237; tak, že se pod sebe naskl&#225;d&#225; vět&#353;&#237; množstv&#237; prvků <code __designer:dtid="1688849860263943">asp:Panel</code>, v&#353;em se nastav&#237; <code __designer:dtid="1688849860263944">visible="False"</code> a na straně serveru se programově zajist&#237;, že se zviditeln&#237; pr&#225;vě jeden.</p>
<p __designer:dtid="1688849860263945">V př&#237;padě verze 2.0 jest v obdobn&#233; situaci použ&#237;ti <code __designer:dtid="1688849860263946">asp:MultiView</code>. Ten obsahuje něco prvků <code __designer:dtid="1688849860263947">asp:View</code>, z nichž pr&#225;vě jeden je aktivn&#237; (viditeln&#253;). Kter&#233;mu z prvků bude svěřena tato v&#253;sada jest specifikovati vlastnost&#237; <code __designer:dtid="1688849860263948">ActiveViewIndex</code>.</p>
<p __designer:dtid="1688849860263949">Jednoduch&#253; př&#237;klad použit&#237; jest zde:</p><pre class="sh-code-xml" __designer:dtid="1688849860263950">&lt;%@ Page Language="VB" %&gt;
<p>&lt;script runat=&quot;server&quot;&gt;
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs)
Me.MultiView1.ActiveViewIndex = Int32.Parse(Me.DropDownList1.SelectedValue)
End Sub
&lt;/script&gt;</p>
<p>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head id=&quot;Head1&quot; runat=&quot;server&quot;&gt;
&lt;title&gt;MultiView example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
&lt;p&gt;
&lt;asp:DropDownList ID=&quot;DropDownList1&quot; runat=&quot;server&quot;&gt;
&lt;asp:ListItem Value=&quot;0&quot; Selected=&quot;true&quot;&gt;Tab #1&lt;/asp:ListItem&gt;
&lt;asp:ListItem Value=&quot;1&quot;&gt;Tab #2&lt;/asp:ListItem&gt;
&lt;asp:ListItem Value=&quot;2&quot;&gt;Tab #3&lt;/asp:ListItem&gt;
&lt;/asp:DropDownList&gt;
&lt;asp:Button ID=&quot;Button1&quot; runat=&quot;server&quot; Text=&quot;Button&quot; OnClick=&quot;Button1_Click&quot; /&gt;
&lt;/p&gt;
&lt;asp:MultiView ID=&quot;MultiView1&quot; runat=&quot;server&quot; ActiveViewIndex=&quot;0&quot;&gt;
&lt;asp:View ID=&quot;ViewTab1&quot; runat=&quot;server&quot;&gt;
Tab 1
&lt;/asp:View&gt;
&lt;asp:View ID=&quot;ViewTab2&quot; runat=&quot;server&quot;&gt;
Tab 2
&lt;/asp:View&gt;
&lt;asp:View ID=&quot;ViewTab3&quot; runat=&quot;server&quot;&gt;
Tab 3
&lt;/asp:View&gt;
&lt;/asp:MultiView&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></p>
<h2 __designer:dtid="1688849860263951">Wizard</h2>
<p __designer:dtid="1688849860263952">Takov&#253; prvek <code __designer:dtid="1688849860263953">MultiView</code> představuje mal&#253; krůček pro člověka, ale velk&#253; krok pro cel&#253; program&#225;torsk&#253; n&#225;rod. Ne př&#237;mou svou samostatnou existenc&#237;, leč skutečnost&#237;, že dal vzniknouti mnohem schopněj&#353;&#237;mu prvku jm&#233;nem <code __designer:dtid="1688849860263954">asp:Wizard</code>.</p>
<p __designer:dtid="1688849860263955">Je doporučeno, aby složitěj&#353;&#237; formul&#225;ře byly realizov&#225;ny formou průvodce, tedy několika na sebe navazuj&#237;c&#237;ch kroků. C&#237;lem je, aby uživatel nebyl hned na prvn&#237; pohled zmaten des&#237;tkami složit&#253;ch formul&#225;řov&#253;ch prvků, ale aby se předmětn&#233; zmaten&#237; dostavovalo postupně, v mal&#253;ch d&#225;vk&#225;ch. Zn&#225;te to: pokud ž&#225;bu hod&#237;te do vař&#237;c&#237; vody, vyskoč&#237; z hrnce. Pokud ji vlož&#237;te do studen&#233; vody a tu budete pomalu zahř&#237;vat, nech&#225; se klidně uvařit. Se ž&#225;bami jsem to nezkou&#353;el, s uživateli ano (želbohu toliko metaforicky): Pokud už se proklikaj&#237; do &#353;est&#233;ho kroku průvodce, je jim zatěžko to vzd&#225;t - zvl&#225;&#353;tě když se jim proz&#237;ravě zataj&#237; že před nimi je dal&#353;&#237;ch pět :-)</p>
<p __designer:dtid="1688849860263956">Napsat dostatečně komfortn&#237;ho průvodce, kter&#253; dovol&#237; přep&#237;nat se korektně pomoc&#237; tlač&#237;tek "<em __designer:dtid="1688849860263957">Předchoz&#237;</em>" a "<em __designer:dtid="1688849860263958">Dal&#353;&#237;</em>", neřku-li jednotliv&#233; kroky vyplňovat na přesk&#225;čku (je-li to ž&#225;douc&#237;) nen&#237; prostředky ASP.NET 1.x rozhodně trivi&#225;ln&#237;. Prostředky 2.0 ano. Použijete prvek <code __designer:dtid="1688849860263959">asp:Wizard</code> a podobn&#253;m způsobem jako u <code __designer:dtid="1688849860263960">MultiView</code> nadefinujete jednotliv&#233; kroky průvodce (VS.NET 2005 v&#225;m dokonce přičinlivě nab&#237;dne vhodn&#233; GUI pro tuto činnost).</p>
<p __designer:dtid="1688849860263961">Pak už zb&#253;v&#225; toliko o&#353;etřit ud&#225;lost <code __designer:dtid="1688849860263962">FinishButtonClick</code>, tedy dokončen&#237; průvodce. Dal&#353;&#237;mi prob&#237;haj&#237;c&#237;mi kroky netřeba se zaob&#237;rati.</p>
<p __designer:dtid="1688849860263963">Z důvodu jeho rozs&#225;hlosti uk&#225;zkov&#253; k&#243;d nen&#237; souč&#225;st&#237; čl&#225;nku, najdete ho v <a href="https://www.cdn.altairis.cz/Blog/2005/20050430-newwebcontrols.zip">přiložen&#233;m souboru př&#237;kladů</a>.</p>
<h2 __designer:dtid="1688849860263964">Substitution</h2>
<p __designer:dtid="1688849860263965">Předpokl&#225;d&#225;m, že vět&#353;ina program&#225;torů jest obezn&#225;mena s mechanismem cacheov&#225;n&#237; v ASP.NET 1.x (patř&#237;te-li mezi onu men&#353;inu, stručn&#233; pojedn&#225;n&#237; na toto t&#233;ma jest nal&#233;zti př&#237;kladně mezi <a href="/Fulltext.aspx?text=cacheov%C3%A1n%C3%AD&idx=a" __designer:dtid="1688849860263966">star&#353;&#237;mi čl&#225;nky na tomto serveru</a>).</p>
<p __designer:dtid="1688849860263967">Mnohdy vyhov&#237; prost&#253; z&#225;pis direktivy <code __designer:dtid="1688849860263968">@OutputCache</code> a cacheov&#225;n&#237; cel&#233; str&#225;nky. Často je ale třeba cache engine poněkud omezit v rozletu a ukl&#225;dat jenom <em __designer:dtid="1688849860263969">něco</em>. Toho jest dos&#225;hnouti ve verzi 1.x t&#237;m, že se č&#225;st str&#225;nky maj&#237;c&#237; podl&#233;hat uložen&#237; do cache realizuje co web user control a cacheuje se ten, zat&#237;mco str&#225;nka jako takov&#225; se vykon&#225; vždy znovu.</p>
<p __designer:dtid="1688849860263970">To je ře&#353;en&#237; elegantn&#237;, leč poněkud nepraktick&#233; v př&#237;padě, že ono shora zm&#237;něn&#233; <em __designer:dtid="1688849860263971">něco</em> je prakticky cel&#225; str&#225;nka, s v&#253;jimkou jedn&#233; či několika mal&#253;ch č&#225;st&#237;. Např&#237;klad z důvodu požadavku marketingov&#233;ho oddělen&#237;, že na webov&#253;ch str&#225;nk&#225;ch prostě <em __designer:dtid="1688849860263972">mus&#237;</em> b&#253;t aktu&#225;ln&#237; čas ;-)</p>
<p __designer:dtid="1688849860263973">V takov&#253;ch př&#237;padech je v nov&#233; verzi k dispozici ovl&#225;dac&#237; prvek <code __designer:dtid="1688849860263974">asp:Substitition</code>. M&#225; jedin&#253; smyslupln&#253; parametr, kter&#253;m je <code __designer:dtid="1688849860263975">MethodName</code>: n&#225;zev metody, kter&#225; se vykon&#225; při každ&#233;m požadavku, a jej&#237;ž v&#253;sledek bude vložen do jinak cacheovan&#233; str&#225;nky na m&#237;sto patřičn&#233;ho prvku <code __designer:dtid="1688849860263976">Substitution</code>.</p>
<p __designer:dtid="1688849860263977">Vizte n&#225;sleduj&#237;c&#237; př&#237;klad:</p><pre class="sh-code-xml" __designer:dtid="1688849860263978">&lt;%@ Page Language="VB" %&gt;
<p>&lt;%@ OutputCache Duration=&quot;60&quot; VaryByParam=&quot;none&quot; %&gt;</p>
<p>&lt;script runat=&quot;server&quot;&gt;</p>
<pre><code>Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)
    Me.Label1.Text = System.DateTime.Now.ToString()
End Sub

Shared Function RefreshSubstitution(ByVal Context As System.Web.HttpContext) As String
    Return System.DateTime.Now.ToString()
End Function
</code></pre>
<p>&lt;/script&gt;</p>
<p>&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
&lt;title&gt;Substitution&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
&lt;div&gt;
&lt;asp:Substitution ID=&quot;Substitution1&quot; runat=&quot;server&quot; MethodName=&quot;RefreshSubstitution&quot; /&gt;
&lt;br /&gt;
&lt;asp:Label ID=&quot;Label1&quot; runat=&quot;server&quot; Text=&quot;Label&quot;&gt;&lt;/asp:Label&gt;
&lt;/div&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></p>
<p __designer:dtid="1688849860263979">Cel&#225; str&#225;nka m&#225; povoleno cacheov&#225;n&#237; v&#253;stupu na dobu jedn&#233; minuty, jak jest vyzkou&#353;eti na obsahu prvku <code __designer:dtid="1688849860263980">Label1</code>, kter&#253; jest v <code __designer:dtid="1688849860263981">Page_Load</code> naplněn aktu&#225;ln&#237;m časem, ale nejčastěji jednou za minutu. Oproti tomu prvek <code __designer:dtid="1688849860263982">Substitution1</code> je vol&#225;n&#237;m metody <code __designer:dtid="1688849860263983">RefreshSubstitution</code> aktualizov&#225;n při každ&#233;m požadavku, cache necache.</p>
<blockquote __designer:dtid="1688849860263984">Můžete si st&#225;hnout <a href="https://www.cdn.altairis.cz/Blog/2005/20050430-newwebcontrols.zip">zdrojov&#233; k&#243;dy</a> k tomuto čl&#225;nku. K jejich rozběhnut&#237; budete potřebovat webov&#253; server podporuj&#237;c&#237; Microsoft .NET Framework 2.0 Beta 2.</blockquote>

      </section>
      <section class="issues">
        <header>
          <i class="fab fa-github">​</i> Je v článku něco špatně? Chcete něco doplnit?</header>
        <p>Komentáře zde nenajdete, ale pokud je v článku chyba nebo k němu chcete něco věcného doplnit, můžete na GitHubu <a href="https://github.com/ridercz/Blog/issues/new?title=Nov%c3%a9+server+controls%3a+MultiView%2c+Wizard+a+Substitution&amp;body=https://www.altair.blog/2005/04/nove-server-controls-multiview-wizard-a-substitution">otevřít nový issue</a> nebo <a href="https://github.com/ridercz/Blog/edit/master/source/2005/04/nove-server-controls-multiview-wizard-a-substitution.md">navrhnout změnu v textu</a> a poslat mi pull request.</p>
      </section>
      <section class="sharing">
        <span>Pošli to dál:</span>
        <ul>
          <li>
            <a href="https://twitter.com/intent/tweet?text=https://www.altair.blog/2005/04/nove-server-controls-multiview-wizard-a-substitution">
              <i class="fab fa-twitter">​</i>
            </a>
          </li>
          <li>
            <a href="https://www.facebook.com/sharer.php?u=https://www.altair.blog/2005/04/nove-server-controls-multiview-wizard-a-substitution">
              <i class="fab fa-facebook-f">​</i>
            </a>
          </li>
        </ul>
      </section>
    </main>
    <footer>
      <ul class="logos">
        <li>
          <img src="/content/images/logo_onwhite.svg" alt="altair.blog" style="height:38px;" />
        </li>
      </ul>
      <ul class="text">
        <li>
          Copyright © <a href="https://www.rider.cz/">Michal Altair Valášek</a>, 2003-2018</li>
        <li>
          Powered by <a href="https://www.xml4web.com/">XML4web</a> on <a href="https://www.github.com/">GitHub Pages</a></li>
        <li>
          <i class="fal fa-rss">​</i> RSS: <a href="/feed.rss">všechno</a> | <a href="/feed-internal.rss">místní</a> | <a href="/feed-external.rss">odkazy</a></li>
      </ul>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/gcode.min.js" integrity="sha256-BfE9r9hXnnA3iCH3rWDpIOy/SX9vd4evlNzmSsi9+TU=" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/less.min.js" integrity="sha256-EB4Qe5B8kOTN9/r65YrBPJ3VkDRJa8sSVqqaIakt0gU=" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/openscad.min.js" integrity="sha256-INIXLRdrhfM2ihtmmR1En9GjWUL7kwseGJUQVC0bN/Y=" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/powershell.min.js" integrity="sha256-cRUESDACI7Yr/eSmoHs6zDQu6HmpAkCp0s4xrZ9RnE0=" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scss.min.js" integrity="sha256-/27cA5aA9DgzXPb747VxVTzwPG/X5tihoKySMSq3bwk=" crossorigin="anonymous">//</script>
    <script type="text/javascript">
                  hljs.initHighlightingOnLoad();
              </script>
  </body>
</html>