<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tajemství souboru app_offline.htm | ALTAIR.blog</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <meta name="Description" content="Magické schopnosti souboru app_offline.htm, přítomné v ASP.NET od verze 2.0, vám mohou usnadnit nasazení a upgrade aplikací." />
    <link rel="stylesheet" type="text/css" href="/content/styles.min.css?sha=B6821C0583D8440A75575E6C465DC5975C8BB563" />
    <link rel="stylesheet" type="text/css" href="/content/fa-5.1.0/css/all.css" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed.rss" title="RSS (všechny články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-internal.rss" title="RSS (pouze místní články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-external.rss" title="RSS (pouze odkazy)" />
    <link rel="shortcut icon" href="https://www.altair.blog/favicon.ico" />
    <link rel="icon" href="https://www.altair.blog/favicon.ico" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@ridercz" />
    <meta name="twitter:title" content="Tajemství souboru app_offline.htm" />
    <meta name="twitter:description" content="Magické schopnosti souboru app_offline.htm, přítomné v ASP.NET od verze 2.0, vám mohou usnadnit nasazení a upgrade aplikací." />
    <meta name="twitter:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="ALTAIR.blog" />
    <meta property="og:title" content="Tajemství souboru app_offline.htm" />
    <meta property="og:description" content="Magické schopnosti souboru app_offline.htm, přítomné v ASP.NET od verze 2.0, vám mohou usnadnit nasazení a upgrade aplikací." />
    <meta property="og:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="og:image:height" content="1200" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:locale" content="cs_CZ" />
    <meta name="robots" content="index, follow" />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/content/images/logo_onblack.svg" alt="altair.blog" style="height:100px;" />
        </a>
      </div>
    </header>
    <nav>
      <ul>
        <li>
          <a href="https://www.rider.cz/" title="Autor: Michal Altair Valášek">
            <i class="fal fa-user"> </i>
          </a>
        </li>
        <li>
          <a href="/archive" title="Archiv článků">
            <i class="fal fa-archive"> </i>
          </a>
        </li>
        <li>
          <a href="/categories" title="Rubriky">
            <i class="fal fa-tags"> </i>
          </a>
        </li>
        <li>
          <a href="/serials" title="Seriály">
            <i class="fal fa-list-alt"> </i>
          </a>
        </li>
        <li>
          <a href="/search" title="Vyhledávání">
            <i class="fal fa-search"> </i>
          </a>
        </li>
        <li>
          <a href="https://www.rider.cz/#contact" title="Kontakt">
            <i class="fal fa-envelope"> </i>
          </a>
        </li>
        <li>
          <a href="https://facebook.com/rider.cz" title="Facebook">
            <i class="fab fa-facebook"> </i>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/ridercz" title="Twitter">
            <i class="fab fa-twitter"> </i>
          </a>
        </li>
        <li>
          <a href="https://github.com/ridercz" title="Github">
            <i class="fab fa-github"> </i>
          </a>
        </li>
        <li>
          <a href="https://ask.fm/ridercz" title="Ask.fm">
            <i class="fal fa-question"> </i>
          </a>
        </li>
      </ul>
    </nav>
    <main>
      <h1>Tajemství souboru app_offline.htm</h1>
      <aside class="article-info">
        <ul class="categories">
          <li>
            <a href="/categories/programovani" title="Rubrika">
              <i class="fal fa-tag"> </i>Programování</a>
          </li>
        </ul>
        <div>
          <a href="https://www.rider.cz/">Michal Altair Valášek </a>
          <i class="fal fa-user">​</i>
        </div>
        <div>
          <time datetime="2008-07-02T23:08:00.123+02:00" title="Datum vydání">2. července 2008 <i class="fal fa-calendar-alt">​</i></time>
        </div>
      </aside>
      <section class="article-text">
        <p>Tenhle článek jsem se chystal napsat už pěkně dlouho, ale vždycky mi do toho něco vlezlo. Týká se tajemného souboru <em>app_offline.htm</em>.</p>
<p>Princip jeho fungování je ve skutečnosti velice prostý. Pokud do rootu webové aplikace umístíte soubor, který se jmenuje <em>app_offline.htm</em> (název je nutné přesně dodržet, s jiným to fungovat nebude), stanou se dvě věci:</p>
<ol>
<li>Ukončí se běh celé aplikace a zruší se její AppDomain.</li>
<li>Veškeré požadavky, které by aplikace jinak vyřizovala (typicky tedy požadavky na soubory .aspx, .ashx atd.) budou vyřízeny tak, že žadatel obdrží obsah souboru <em>app_offline.htm</em>.</li>
</ol>
<p>Ukončení aplikace budete typicky využívat v případě, že chcete aplikaci, nebo její části, upgradovat. Uvolní se totiž všechny soubory, které by aplikace mohla používat, uzavřou se všechna databázová spojení atd. Do souboru byste měli též zapsat nějaký smysluplný text, který vašim uživatelům sdělí, že se jedná o plánovaný výpadek a že nemají propadat panice.</p>
<p>I když informace sama je většinou svou podstatou stručná, velikost souboru by měla být větší než 512 bajtů. Ne z hlediska ASP.NET (aplikaci vám shodí i prázdný soubor, na jeho obsahu nezáleží), ale protože Internet Explorer v případě chybových stavů s odpovědí kratší než 512 bajtů zobrazí svou vlastní generickou chybovou hlášku (obávané “Stránku nelze zobrazit”) a ne vámi definovaný text. Inspiraci můžete načerpat například v <a href="http://www.aspnet.cz/_app_offline.htm">jeho znění na tomto serveru</a> (mám ve zvyku tento soubor ve všech aplikacích trvale uchovávat a jenom ho přejmenovat, když není třeba, proto to podtržítko na začátku).</p>
<p>Takovéto odstavení aplikace vám také umožní aktualizovat ad-hoc připojený databázový soubor v případě user instance SQL Serveru Express. Ovšem pouze za předpokladu, že jste jejím jediným uživatelem.</p>
<p>Poté, co upgrade dokončíte, stačí soubor <em>app_offline.htm</em> smazat a nebo přejmenovat. První další požadavek na danou aplikaci ji znovu nastartuje.</p>

      </section>
      <section class="sharing">
        <span>Pošli to dál:</span>
        <ul>
          <li>
            <a href="https://twitter.com/intent/tweet?text=https://www.altair.blog/2008/07/tajemstvi-souboru-app-offline-htm">
              <i class="fab fa-facebook-f">​</i>
            </a>
          </li>
          <li>
            <a href="https://www.facebook.com/sharer.php?u=https://www.altair.blog/2008/07/tajemstvi-souboru-app-offline-htm">
              <i class="fab fa-twitter">​</i>
            </a>
          </li>
        </ul>
      </section>
    </main>
    <footer>
      <ul class="logos">
        <li>
          <img src="/content/images/logo_onwhite.svg" alt="altair.blog" style="height:38px;" />
        </li>
      </ul>
      <ul class="text">
        <li>
          Copyright © <a href="https://www.rider.cz/">Michal Altair Valášek</a>, 2003-2018</li>
        <li>
          Powered by <a href="https://www.xml4web.com/">XML4web</a> on <a href="https://www.github.com/">GitHub Pages</a></li>
        <li>
          <i class="fal fa-rss">​</i> RSS: <a href="/feed.rss">všechno</a> | <a href="/feed-internal.rss">místní</a> | <a href="/feed-external.rss">odkazy</a></li>
      </ul>
    </footer>
  </body>
</html>