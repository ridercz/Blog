<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Zázraky se dějí | ALTAIR.blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <link rel="canonical" href="https://www.altair.blog/2018/11/zazraky-se-deji" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.css" integrity="sha512-LaxQmGd9k/pW51CsEy2nLIlbUXCgsyvUEVT5fSguN2b2OBwHjMi2aiUdEEXSMg8Jvy+bCB01as61aNrHnL2DYQ==" crossorigin="anonymous" />
    <link rel="stylesheet" type="text/css" href="/content/styles.min.css?sha=958FDE84446584982622A36C117C0CB25FEAEF0C" />
    <link rel="stylesheet" type="text/css" href="/content/fa-5.13.1/css/all.min.css" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed.rss" title="RSS (všechny články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-internal.rss" title="RSS (pouze místní články)" />
    <link rel="alternate" type="application/rss+xml" href="https://www.altair.blog/feed-external.rss" title="RSS (pouze odkazy)" />
    <link rel="shortcut icon" href="https://www.altair.blog/favicon.ico" />
    <link rel="icon" href="https://www.altair.blog/favicon.ico" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@ridercz" />
    <meta name="twitter:title" content="Zázraky se dějí" />
    <meta name="twitter:description" content="Žijeme v turbulentní době a skutečnosti, dříve pokládány za neměnné, se hroutí jako domečky z karet. Naposledy se tímto stylem zhroutila jedna z konstant českého Internetu, když weby Ministerstva vnitra a Policie ČR začaly podporovat HTTPS. Samozřejmě, není všechno zlato co se třpytí, takže i když mají weby mvcr.cz a policie.cz ono magické &quot;S&quot; na konci protokolu, v testu kvality implementace dostaly od Qualysu známku F - tedy nejhorší možnou." />
    <meta name="twitter:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="article:published_time" content="2018-11-05T12:00:00" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="ALTAIR.blog" />
    <meta name="author" content="Michal Altair Valášek" />
    <meta name="title" property="og:title" content="Zázraky se dějí" />
    <meta name="description" property="og:description" content="Žijeme v turbulentní době a skutečnosti, dříve pokládány za neměnné, se hroutí jako domečky z karet. Naposledy se tímto stylem zhroutila jedna z konstant českého Internetu, když weby Ministerstva vnitra a Policie ČR začaly podporovat HTTPS. Samozřejmě, není všechno zlato co se třpytí, takže i když mají weby mvcr.cz a policie.cz ono magické &quot;S&quot; na konci protokolu, v testu kvality implementace dostaly od Qualysu známku F - tedy nejhorší možnou." />
    <meta name="image" property="og:image" content="https://www.altair.blog/content/images/preview-1200.jpg" />
    <meta property="og:locale" content="cs_CZ" />
    <meta property="og:url" content="https://www.altair.blog/2018/11/zazraky-se-deji" />
    <script>
      (function(f, a, t, h, o, m){
        a[h]=a[h]||function(){
          (a[h].q=a[h].q||[]).push(arguments)
        };
        o=f.createElement('script'),
        m=f.getElementsByTagName('script')[0];
        o.async=1; o.src=t; o.id='fathom-script';
        m.parentNode.insertBefore(o,m)
      })(document, window, '//stats.altair.blog/tracker.js', 'fathom');
      fathom('set', 'siteId', 'OBOTR');
      fathom('trackPageview');
    </script>
    <script src="/content/scripts/autocorrect.js" defer="defer" onload="typo.runAutoCorrector()">//</script>
    <meta name="robots" content="index, follow" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css" integrity="sha512-kZqGbhf9JTB4bVJ0G8HCkqmaPcRgo88F0dneK30yku5Y/dep7CZfCnNml2Je/sY4lBoqoksXz4PtVXS4GHSUzQ==" crossorigin="anonymous" />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/content/images/logo_onblack.svg" alt="altair.blog" style="max-height:100px;max-width:80%" />
        </a>
      </div>
    </header>
    <nav>
      <ul>
        <li>
          <a href="https://www.rider.cz/" title="Autor: Michal Altair Valášek">
            <i class="fal fa-fw fa-user"> </i>
          </a>
        </li>
        <li>
          <a href="/archive" title="Archiv článků">
            <i class="fal fa-fw fa-archive"> </i>
          </a>
        </li>
        <li>
          <a href="/categories" title="Rubriky">
            <i class="fal fa-fw fa-tags"> </i>
          </a>
        </li>
        <li>
          <a href="/serials" title="Seriály">
            <i class="fal fa-fw fa-list-alt"> </i>
          </a>
        </li>
        <li>
          <a href="/search" title="Vyhledávání">
            <i class="fal fa-fw fa-search"> </i>
          </a>
        </li>
        <li>
          <a href="https://www.rider.cz/#contact" title="Kontakt">
            <i class="fal fa-fw fa-envelope"> </i>
          </a>
        </li>
        <li>
          <a href="https://facebook.com/rider.cz" title="Facebook">
            <i class="fab fa-fw fa-facebook"> </i>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/ridercz" title="Twitter">
            <i class="fab fa-twitter"> </i>
          </a>
        </li>
        <li>
          <a href="https://github.com/ridercz" title="Github">
            <i class="fab fa-fw fa-github"> </i>
          </a>
        </li>
        <li>
          <a href="https://ask.fm/ridercz" title="Ask.fm">
            <i class="fal fa-fw fa-question"> </i>
          </a>
        </li>
      </ul>
    </nav>
    <main>
      <h1>Zázraky se dějí</h1>
      <aside class="article-info">
        <ul class="categories">
          <li>
            <a href="/categories/bezpecnost" title="Rubrika">
              <i class="fal fa-tag"> </i>Bezpečnost</a>
          </li>
        </ul>
        <div title="Autor">
          <a href="https://www.rider.cz/">Michal Altair Valášek </a>
          <i class="fal fa-user">​</i>
        </div>
        <div title="Datum vydání">
          <time datetime="2018-11-05T12:00:00">5. listopadu 2018 <i class="fal fa-calendar-alt">​</i></time>
        </div>
      </aside>
      <section class="article-text">
        <p>Žijeme v turbulentní době a skutečnosti, dříve pokládány za neměnné, se hroutí jako domečky z karet. Naposledy se tímto stylem zhroutila jedna z konstant českého Internetu, když weby Ministerstva vnitra a Policie ČR začaly podporovat HTTPS. Samozřejmě, není všechno zlato co se třpytí, takže i když mají weby mvcr.cz a policie.cz ono magické &quot;S&quot; na konci protokolu, v testu kvality implementace dostaly od Qualysu známku F - tedy nejhorší možnou.</p>
<p>Princip &quot;HTTPS Everywhere&quot;, tedy že pokud možno všechny weby by měly fungovat přes HTTPS, tady s námi je už nějakou dobu. Jeden čtenář serveru root.cz se <a href="https://www.root.cz/zpravicky/proc-nema-policie-ceske-repubiky-na-webu-https/">zeptal na důvod</a>. Odpověď vrchního komisaře kpt. Mgr. Michala Michálka je fascinující:</p>
<p><img src="https://www.cdn.altairis.cz/Blog/2018/20181105-pcr-odpoved.jpg" alt="Odpověď PČR" /></p>
<p>Je to samozřejmě naprostý blábol. Část tvrzení je prokazatelně lživá, část nesmyslná, část nesrozumitelná. Začal jsem tedy pátrat po tom, nakolik to s tou odpovědí myslí vážně.</p>
<p>Výsledkem byla zhruba hodinová schůzka, na které mi pět zaměstnanců ministerstva vnitra vysvětlovalo, proč HTTPS zavést prostě nelze, přesně podle hesla &quot;kdo chce, hledá způsoby, kdo nechce, hledá důvody&quot;. Základní opakující se motivy byly zhruba stejné, jako vždy, když jsem v rámci státní správy řešil nějaký průšvih:</p>
<ol>
<li><strong>Nedovedete si představit, jak to máme ve státní správě težké a komplikované.</strong> Představivost mám myslím docela dobrou; nevylučuji nicméně, že i moje fantazie nestačí na drsnou realitu kruté džungle státní správy.</li>
<li><strong>My bychom rádi, ale nemáme na to peníze.</strong> Účinnost tohoto argumentu poněkud snižuje skutečnost, že náklady na vypracování obsáhlých zdůvodnění proč něco nejde a uspořádání oné schůzky by pokryly náklady na certifikáty na přibližně deset let dopředu.</li>
</ol>
<p>Nyní tedy peklo zmrzlo a před adresami <code>www.mvcr.cz</code> a <code>www.policie.cz</code> se objevilo ono magické <code>https://</code>. Samozřejmě první co jsem udělal, bylo zkusit na web MVČR poštvat <a href="https://www.ssllabs.com/ssltest/analyze.html?d=www.mvcr.cz">nástroj SSL Test</a> od společnosti Qualys. Ten provede obsáhlé zhodnocení nastavení serveru a vystaví mu známku jako v (americké) škole. A+ je nejlepší a nejhorší je F - failed.</p>
<p>Jak dopadly weby MV a PČR? <em>(Pro screenshot úplného výsledku klepněte na obrázek.)</em></p>
<p><a href="https://www.cdn.altairis.cz/Blog/2018/20181105-ssltest-mvcr-full.png"><img src="https://www.cdn.altairis.cz/Blog/2018/20181105-ssltest-mvcr-small.png" alt="Výsledek hodnocení SSL Testu" /></a></p>
<h2 id="co-je-spatne">Co je špatně</h2>
<p>Problém se zabezpečením komunikace prostřednictvím HTTPS je, že nestačí jenom aby váš web byl dostupný, když se do adresního řádku prohlížeče napíše <code>https://</code>. To samo o sobě be skutečnosti znamená jenom málo. Aby vám všechny ty certifikáty a udělátka byla k něčemu dobrá, je ještě nezbytné zkonfigurovat značné množství parametrů.</p>
<p>V první řadě je nezbytné zakázat staré a nebezpečné protokoly, zejména pak všechny verze SSL a ponechat jenom aktuální verze TLS. Vnitro je v tomto ohledu na půl cesty: nepodporuje žádnou verzi SSL (což je dobře), ale podporuje zastaralé verze TLS 1.0 a 1.1. Což je... řekněme že v rozporu s best practices. Nepředstavuje bezprostřední ohrožení, ale nemá budoucnost (prohlížeče ho během cca. roku přestanou podporovat) a u nové instalace podle mého soudu nedává smysl.</p>
<p>V řadě druhé záleží na nastavení takzvaných cipher suites, tedy kombinací kryptografických algoritmů a parametrů, které se pro šifrování nakonec reálně použijí. Server MVČR důsledně preferuje ty kombinace šifer, které jsou pokládány za slabé a nedoporučované.</p>
<p>To je také jádrem oné známky F, kterou si web vysloužil za napadnutelnost útokem <a href="https://robotattack.org/">Return Of Bleichenbacher's Oracle Threat (ROBOT)</a>. Web podporuje cipher suites rodiny <code>TLS_RSA_*</code>, které nejsou pokládány za bezpečné a jsou tímto útokem napadnutelné. Podporuje i modernější cipher suites, založené na Diffie-Hellman výměně klíčů, včetně varianty s eliptickými křivkami, ale implementace DHE je chybná. Nepodporuje forward secrecy, takže v případě prozrazení privátního klíče serveru lze zpětně dešifrovat zachycenou komunikaci.</p>
<p>Pokud se na to dobře dívám a na nic jsem nezapomněl, žádná ze zranitelností neznamená úplně bezprostřední a akutní ohrožení zásadního aspektu aplikace HTTPS na webu tohoto typu, kterým je autentizace serveru a zaručení integrity předávaných dat. Ale není to ani dobře nastavené. Rozhodně to není v souladu s best practices (o některých z nich a budoucnosti HTTPS jsem psal v <a href="https://tech.ihned.cz/c7-66303170-psms7-0b5ed1a1a1ded3c">nedávném článku pro Hospodářky</a>).</p>
<p>Těžko říci, co je důvodem takovéhle zapeklité situace. Samozřejmě to může být prostá neznalost. Že státní správa nedokáže zaplatit špičkové IT odborníky, protože nabízí mizerné podmínky (nejen finanční) je všeobecně známo, tak si holt musí vystačit s tím, co na ni zbude. Možná je to nějaká zoufalá snaha o zpětnou kompatibilitu. Ovšem bavíme se o kompatibilitě s dávno zavrženými platformami jako Internet Explorer 8 na Windows XP nebo dvojkové verze Androidu.</p>
<p>Weby MVČR a Policie dnes připomínají někoho, kdo visí na útesu za konečky prstů. Sice se těší úplnému zdraví a technicky vzato mu skoro nic neschází... Stačí ale málo, aby se situace dramaticky změnila.</p>

      </section>
      <section class="issues">
        <header>
          <i class="fab fa-github">​</i> Je v článku něco špatně? Chcete něco doplnit?</header>
        <p>Komentáře zde nenajdete, ale pokud je v článku chyba nebo k němu chcete něco věcného doplnit, můžete na GitHubu <a href="https://github.com/ridercz/Blog/issues/new?title=Z%c3%a1zraky+se+d%c4%9bj%c3%ad&amp;body=https://www.altair.blog/2018/11/zazraky-se-deji">otevřít nový issue</a> nebo <a href="https://github.com/ridercz/Blog/edit/master/source/2018/11/zazraky-se-deji.md">navrhnout změnu v textu</a> a poslat mi pull request.</p>
        <p>Tamtéž také najdete <a href="https://github.com/ridercz/Blog/commits/master/source/2018/11/zazraky-se-deji.md">historii všech verzí článku</a>, pokud v něm byly provedeny nějaké změny či úpravy.</p>
      </section>
      <section class="sharing">
        <span>Pošli to dál:</span>
        <ul>
          <li>
            <a href="https://twitter.com/intent/tweet?text=https://www.altair.blog/2018/11/zazraky-se-deji">
              <i class="fab fa-twitter">​</i>
            </a>
          </li>
          <li>
            <a href="https://www.facebook.com/sharer.php?u=https://www.altair.blog/2018/11/zazraky-se-deji">
              <i class="fab fa-facebook-f">​</i>
            </a>
          </li>
        </ul>
      </section>
    </main>
    <footer>
      <ul class="logos">
        <li>
          <img src="/content/images/logo_onwhite.svg" alt="altair.blog" style="height:38px;" />
        </li>
      </ul>
      <ul class="text">
        <li>
          Copyright © <a href="https://www.rider.cz/">Michal Altair Valášek</a>, 2003-2021</li>
        <li>
          Powered by <a href="https://www.xml4web.com/">XML4web</a> on <a href="https://www.github.com/">GitHub Pages</a></li>
        <li>
          <i class="fal fa-rss">​</i> RSS: <a href="/feed.rss">všechno</a> | <a href="/feed-internal.rss">místní</a> | <a href="/feed-external.rss">odkazy</a></li>
      </ul>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha512-lnOllyZZlRk/gQIyjS3+h+LUy54uyM4aGq2zbGc82KTvBlp/fodSpdh/pywPztpU9zUqHcJr+jP+a1zLa9oCJw==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/csharp.min.js" integrity="sha512-dQorbxHDJF0jQ9jDdUgFc3PfpIxRV18/EMI7ToQTe2fbD8HAms+eNjpLI+A0SMB/YQIc/NeFhBYSX/UCaEoIzg==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/css.min.js" integrity="sha512-UBNT6+S1FuSLwHTzfo6BqVU4AOKftOiict0fXKr4Vwz3YIjgsVURHxzHg3wWIwDawWumMO7JrluSLost+8i3UA==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/dos.min.js" integrity="sha512-LRcU/W7unzxQuTXoNa9NeNEoRXpWF/VQox8aCXnYPJHr21ymV27zmTXxxPALiMvDuFVMMBLHHUGXCiYFiR2uZg==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/javascript.min.js" integrity="sha512-B2u4F4jxoEQ90yVLebzbcexcdZGtECyokKRU0ribbBBxcsZFn6i4n9AU7UjmMFHj08AYiY0GrZsom5lWoZTY3g==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/markdown.min.js" integrity="sha512-utO8hnm2PGjXvKsyf/H6ZUaFlctc2aiDmC9fNqcyycD8rEAxFM6rTrcpY9MUfkbrXLF9tfU8kQWD9dotZ77gKQ==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/openscad.min.js" integrity="sha512-bSZUmtiZseL0VujlVGN75faBxoAE9RAyJaDjAb+vd/RgWupGOxaZ79PKBHRtZTim+xgC5aCUPkpGlQt5Lw5TlA==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/powershell.min.js" integrity="sha512-PwV5Q67iPMuWqs6aDWCmrGm7keyzorPmleIF2Qe27hvQIvwxL7RUSCR4ChRjTZYYMM60FxrGOOhudyNYhqTdYw==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/scss.min.js" integrity="sha512-E2Gmd9vH0BXoGHlWshFIjW985slDBATPs4P4OJo9vK9zBvvKUJsQTDTuQAPaZ2xiDAvL6gZ7j9tdj1Nx8I6/8g==" crossorigin="anonymous">//</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/xml.min.js" integrity="sha512-dICltIgnUP+QSJrnYGCV8943p3qSDgvcg2NU4W8IcOZP4tdrvxlXjbhIznhtVQEcXow0mOjLM0Q6/NvZsmUH4g==" crossorigin="anonymous">//</script>
    <script>
                  hljs.initHighlightingOnLoad();
              </script>
  </body>
</html>