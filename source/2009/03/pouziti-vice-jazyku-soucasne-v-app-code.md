<!-- dcterms:identifier = aspnetcz#223 -->
<!-- dcterms:title = Použití více jazyků současně v App_Code -->
<!-- dcterms:abstract = Je všeobecně známo, že ve webových aplikacích je možné různé stránky psát v různých jazycích. Jednu stránku můžete mít třeba v C#, druhou ve VB.NET a třetí v F#. Každá stránka se zkompiluje do samostatné assembly a nezáleží na tom, jaký byl původn jazyk – CLI si s tím poradí. Ale co s App_Code, který je jenom jeden. -->
<!-- np9:categoryId = 1 -->
<!-- x4w:category = IT -->
<!-- np9:authorId = 1 -->
<!-- np9:authorEmail = michal.valasek@altairis.cz -->
<!-- dcterms:creator = Michal Altair Valášek -->
<!-- dcterms:created = 2009-03-13T19:34:44.45+01:00 -->
<!-- dcterms:dateAccepted = 2009-03-13T19:34:44.45+01:00 -->

<p><img style="border-right-width: 0px; margin: 0px 0px 10px 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Vícejazyčný projekt" border="0" alt="Vícejazyčný projekt" align="right" src="https://www.cdn.altairis.cz/Blog/2009/20090313-20090313-multilang_3.png" width="289" height="241"> Je všeobecně známo, že ve webových aplikacích je možné různé stránky psát v různých jazycích. Jednu stránku můžete mít třeba v C#, druhou ve VB.NET a třetí v F#. Každá stránka se zkompiluje do samostatné assembly a nezáleží na tom, jaký byl původn jazyk – CLI si s tím poradí.</p>  <p>Shora uvedené assemblies se ovšem &quot;navzájem nevidí&quot;. Vzhledem k možnosti kompilace on demand se ve web site projektech nemůžete odkazovat z jedné třídy ASPX stránky na jinou. Sdílené třídy je tedy nutné uložit do samostatného adresáře <em>App_Code</em>, který se kompiluje jako první a zvlášť. </p>  <p>Dlouho jsem si myslel (a tento názor též šířil dále), že zde možnost používat více jazyků současně končí. Inu, nekončí. Prostor adresáře <em>App_Code</em> totiž lze rozdělit pomocí podadresářů a v konfiguraci určit, že se budou kompilovat samostatně. A v každém z těchto podadresářů je pak možné mít kód v jiném jazyce.</p>  <p>Můžete si tedy vytvořit strukturu projektu podobně, jako na obrázku. V adresáři <em>App_Code</em> vytvořte podadresáře <em>cs</em> a <em>vb</em> (je nicméně jedno, jak se budou jmenovat). </p>  <p>Potom v souboru web.config přidejte názvy adresářů do <em>/configuration/system.web/compilation/codeSubDirectories</em>:</p>  <div style="font-family: consolas, courier new; background: white; color: black; font-size: 12pt">   <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">configuration</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">system.web</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">compilation</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">codeSubDirectories</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">add</span><span style="color: blue"> </span><span style="color: red">directoryName</span><span style="color: blue">=</span>&quot;<span style="color: blue">cs</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">add</span><span style="color: blue"> </span><span style="color: red">directoryName</span><span style="color: blue">=</span>&quot;<span style="color: blue">vb</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">codeSubDirectories</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">compilation</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">system.web</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">configuration</span><span style="color: blue">&gt;</span></p> </div>  <h2>A k čemu je to všechno dobré?</h2>  <p>Logická otázka se nabízí: a k čemu je to všechno dobré? Napadají mne tři využití:</p>  <ol>   <li>Hotový subsystém, který je k dispozici pouze v jiném jazyce, než je ten váš. To se typicky týká VB.NET programátorů, neboť množství modulů je k dispozici jenom v C#. Použití code subdirectory může být jednodušší, než vytváření a referencování samostatné class library. </li>    <li>Ne všechny jazyky jsou si rovny. Kromě VB.NET a C# je tu i funkcionální F# a dynamické jazyky typu IronPython a IronRuby. Vyznačují se typicky výhodností pro určité typy úloh a faktickou nepoužitelností pro všechny ostatní. Pokud ve vaší aplikaci rešíte některou z těch prvně uvedených, může se vám tato funkcionalita hodit. </li>    <li>No a do třetice všeho dobrého, tento trik se vám může hodit v budoucnu, až Microsoft uvede jistou technologii, s jejímž preview jsme byli seznámeni na letošním MVP Summitu. Výše uvedený trik jsem se dozvěděl právě tam a je to bohužel to jediné, co z celé přednášky není pod NDA… </li> </ol>